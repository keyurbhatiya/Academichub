{% load static %}

<header class="sticky top-0 z-50 backdrop-blur-lg bg-white/80 shadow-sm border-b border-gray-200" role="banner">
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center" aria-label="Main navigation">
        
        <!-- Logo -->
        <a href="{% url 'home' %}" class="text-2xl font-['Pacifico'] text-blue-600 tracking-wide hover:opacity-90 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" aria-label="AcademicHub Home">
            AcademicHub
        </a>

        <!-- Desktop Menu -->
        <div class="hidden md:flex items-center space-x-8" role="navigation">
            <a href="{% url 'home' %}"
               class="{% if request.resolver_match.url_name == 'home' %}text-blue-600 font-semibold border-b-2 border-blue-600{% else %}text-gray-700 hover:text-blue-600 hover:border-b-2 hover:border-blue-600 transition-colors{% endif %} pb-2 text-sm font-medium"
               aria-current="{% if request.resolver_match.url_name == 'home' %}page{% else %}false{% endif %}">
                Home
            </a>
            <a href="{% url 'papers' %}"
               class="{% if request.resolver_match.url_name == 'papers' %}text-blue-600 font-semibold border-b-2 border-blue-600{% else %}text-gray-700 hover:text-blue-600 hover:border-b-2 hover:border-blue-600 transition-colors{% endif %} pb-2 text-sm font-medium"
               aria-current="{% if request.resolver_match.url_name == 'papers' %}page{% else %}false{% endif %}">
                Papers
            </a>
            <a href="{% url 'projects' %}"
               class="{% if request.resolver_match.url_name == 'projects' %}text-blue-600 font-semibold border-b-2 border-blue-600{% else %}text-gray-700 hover:text-blue-600 hover:border-b-2 hover:border-blue-600 transition-colors{% endif %} pb-2 text-sm font-medium"
               aria-current="{% if request.resolver_match.url_name == 'projects' %}page{% else %}false{% endif %}">
                Projects
            </a>
            <a href="{% url 'blogs' %}"
               class="{% if request.resolver_match.url_name == 'blogs' %}text-blue-600 font-semibold border-b-2 border-blue-600{% else %}text-gray-700 hover:text-blue-600 hover:border-b-2 hover:border-blue-600 transition-colors{% endif %} pb-2 text-sm font-medium"
               aria-current="{% if request.resolver_match.url_name == 'blogs' %}page{% else %}false{% endif %}">
                Blogs
            </a>
        </div>

        <!-- Right Section -->
        <div class="flex items-center space-x-4">
            {% if user.is_authenticated %}
            <!-- Profile Dropdown -->
            <div class="relative">
                <button id="profileDropdownButton" class="flex items-center space-x-3 hover:opacity-90 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" aria-haspopup="true" aria-expanded="false" aria-label="User profile menu">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 text-white flex items-center justify-center font-semibold text-sm">
                        {% firstof user.first_name|slice:":1" user.username|slice:":1" %}
                    </div>
                    <span class="hidden md:block text-sm font-medium text-gray-800">
                        {% firstof user.first_name user.username %}
                    </span>
                    <i class="ri-arrow-down-s-line text-gray-600"></i>
                </button>
                <div id="profileDropdown" class="hidden absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden transition-all duration-300 transform scale-95 opacity-0" aria-hidden="true">
                    <a href="{% url 'profile' %}" class="block px-5 py-3 text-sm text-gray-700 hover:bg-gray-100 hover:text-blue-600 transition-colors">Profile</a>
                    <a href="{% url 'user_uploads' %}" class="block px-5 py-3 text-sm text-gray-700 hover:bg-gray-100 hover:text-blue-600 transition-colors">My Uploads</a>
                    <div class="border-t border-gray-200"></div>
                    <a href="{% url 'logout' %}" class="block px-5 py-3 text-sm text-red-600 hover:bg-gray-100 hover:text-red-700 transition-colors">Logout</a>
                </div>
            </div>
            {% else %}
            <!-- Login/Signup Buttons -->
            <a href="{% url 'login' %}" class="text-sm font-medium text-gray-700 hover:text-blue-600 transition-colors">Login</a>
            <a href="{% url 'register' %}" class="text-sm font-medium text-white bg-blue-600 px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">Sign Up</a>
            {% endif %}

            <!-- Mobile Menu Button -->
            <button class="md:hidden w-10 h-10 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" id="mobileMenuButton" aria-label="Toggle mobile menu" aria-expanded="false">
                <i class="ri-menu-line text-gray-700 ri-lg"></i>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-gray-200 px-6 py-4 transition-all duration-300 transform scale-y-0 origin-top" aria-hidden="true">
        <div class="flex flex-col space-y-4">
            <a href="{% url 'home' %}" class="text-gray-800 font-medium hover:text-blue-600 transition-colors" aria-current="{% if request.resolver_match.url_name == 'home' %}page{% else %}false{% endif %}">Home</a>
            <a href="{% url 'papers' %}" class="text-gray-800 font-medium hover:text-blue-600 transition-colors" aria-current="{% if request.resolver_match.url_name == 'papers' %}page{% else %}false{% endif %}">Papers</a>
            <a href="{% url 'projects' %}" class="text-gray-800 font-medium hover:text-blue-600 transition-colors" aria-current="{% if request.resolver_match.url_name == 'projects' %}page{% else %}false{% endif %}">Projects</a>
            <a href="{% url 'blogs' %}" class="text-gray-800 font-medium hover:text-blue-600 transition-colors" aria-current="{% if request.resolver_match.url_name == 'blogs' %}page{% else %}false{% endif %}">Blogs</a>
            {% if not user.is_authenticated %}
            <div class="border-t border-gray-200 my-2"></div>
            <!-- <a href="{% url 'login' %}" class="text-gray-800 font-medium hover:text-blue-600 transition-colors">Login</a>
            <a href="{% url 'register' %}" class="text-gray-800 font-medium hover:text-blue-600 transition-colors">Sign Up</a> -->
            {% endif %}
        </div>
    </div>
</header>

<!-- Schema.org Structured Data for Navigation -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "SiteNavigationElement",
    "name": [
        "Home",
        "Papers",
        "Projects",
        "Blogs"
    ],
    "url": [
        "{% url 'home' %}",
        "{% url 'papers' %}",
        "{% url 'projects' %}",
        "{% url 'blogs' %}"
    ]
}
</script>

<script defer>
    document.addEventListener('DOMContentLoaded', () => {
        // Mobile Menu Toggle
        const mobileMenuButton = document.getElementById('mobileMenuButton');
        const mobileMenu = document.getElementById('mobileMenu');
        mobileMenuButton.addEventListener('click', () => {
            const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
            mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
            mobileMenu.classList.toggle('hidden');
            mobileMenu.classList.toggle('scale-y-0');
            mobileMenu.classList.toggle('scale-y-100');
            mobileMenu.setAttribute('aria-hidden', isExpanded);
        });

        // Profile Dropdown Toggle
        const profileDropdownButton = document.getElementById('profileDropdownButton');
        const profileDropdown = document.getElementById('profileDropdown');
        if (profileDropdownButton && profileDropdown) {
            profileDropdownButton.addEventListener('click', () => {
                const isExpanded = profileDropdownButton.getAttribute('aria-expanded') === 'true';
                profileDropdownButton.setAttribute('aria-expanded', !isExpanded);
                profileDropdown.classList.toggle('hidden');
                profileDropdown.classList.toggle('scale-95');
                profileDropdown.classList.toggle('scale-100');
                profileDropdown.classList.toggle('opacity-0');
                profileDropdown.classList.toggle('opacity-100');
                profileDropdown.setAttribute('aria-hidden', isExpanded);
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (event) => {
                if (!profileDropdownButton.contains(event.target) && !profileDropdown.contains(event.target)) {
                    profileDropdownButton.setAttribute('aria-expanded', 'false');
                    profileDropdown.classList.add('hidden', 'scale-95', 'opacity-0');
                    profileDropdown.classList.remove('scale-100', 'opacity-100');
                    profileDropdown.setAttribute('aria-hidden', 'true');
                }
            });
        }
    });
</script>